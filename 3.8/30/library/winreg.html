
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>winreg --- Windows レジストリへのアクセス &#8212; Python 3.8.3rc1 ドキュメント</title>
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.8.3rc1 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="winsound --- Windows 用の音声再生インタフェース" href="winsound.html" />
    <link rel="prev" title="msvcrt --- MS VC++実行時システムの有用なルーチン群" href="msvcrt.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/winreg.html" />
    
      
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
     


  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="winsound.html" title="winsound --- Windows 用の音声再生インタフェース"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" title="msvcrt --- MS VC++実行時システムの有用なルーチン群"
             accesskey="P">前へ</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <a href="../index.html">3.8.3rc1 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows.html" accesskey="U">MS Windows 固有のサービス</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" type="text" name="q" />
          <input type="submit" value="検索" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-winreg">
<span id="winreg-windows-registry-access"></span><h1><a class="reference internal" href="#module-winreg" title="winreg: Routines and objects for manipulating the Windows registry. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">winreg</span></code></a> --- Windows レジストリへのアクセス<a class="headerlink" href="#module-winreg" title="このヘッドラインへのパーマリンク">¶</a></h1>
<hr class="docutils" />
<p>これらの関数は Windows レジストリ API を Python から使えるようにします。プログラマがレジストリハンドルを明示的にクローズするのを忘れた場合でも、確実にハンドルがクローズされるようにするために、レジストリハンドルとして整数値ではなく <a class="reference internal" href="#handle-object"><span class="std std-ref">ハンドルオブジェクト</span></a> が使われます。</p>
<div class="versionchanged" id="exception-changed">
<p><span class="versionmodified">バージョン 3.3 で変更: </span>このモジュールのいくつかの関数は以前は <a class="reference internal" href="exceptions.html#WindowsError" title="WindowsError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WindowsError</span></code></a> を送出していました。それは今では <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> の別名です。</p>
</div>
<div class="section" id="functions">
<span id="id1"></span><h2>関数<a class="headerlink" href="#functions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>このモジュールでは以下の関数を提供します:</p>
<dl class="function">
<dt id="winreg.CloseKey">
<code class="descclassname">winreg.</code><code class="descname">CloseKey</code><span class="sig-paren">(</span><em>hkey</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CloseKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>以前開かれたレジストリキーを閉じます。<em>hkey</em> 引数は以前開かれたレジストリキーを指定します。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">このメソッドを使って (または <a class="reference internal" href="#winreg.PyHKEY.Close" title="winreg.PyHKEY.Close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hkey.Close()</span></code></a> によって) <em>hkey</em> が閉じられなかった場合、Python が <em>hkey</em> オブジェクトを破壊する際に閉じられます。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.ConnectRegistry">
<code class="descclassname">winreg.</code><code class="descname">ConnectRegistry</code><span class="sig-paren">(</span><em>computer_name</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ConnectRegistry" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>他のコンピュータ上にある事前に定義されたレジストリハンドルとの接続を確立し、 <a class="reference internal" href="#handle-object"><span class="std std-ref">ハンドルオブジェクト</span></a> を返します。</p>
<p><em>computer_name</em> はリモートコンピュータの名前で、<code class="docutils literal notranslate"><span class="pre">r&quot;\\computername&quot;</span></code> の形式をとります。<code class="docutils literal notranslate"><span class="pre">None</span></code> の場合、ローカルのコンピュータが使われます。</p>
<p><em>key</em> は、事前に定義された接続先のハンドルです。</p>
<p>戻り値は開かれたキーのハンドルです。関数が失敗した場合、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.ConnectRegistry</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">computer_name</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.CreateKey">
<code class="descclassname">winreg.</code><code class="descname">CreateKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CreateKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーを生成するか開き、 <a class="reference internal" href="#handle-object"><span class="std std-ref">ハンドルオブジェクト</span></a> を返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> はこのメソッドが開く、または新規作成するキーの名前です。</p>
<p><em>key</em> が事前に定義されたキーのうちの一つなら、<em>sub_key</em> は <code class="docutils literal notranslate"><span class="pre">None</span></code> でかまいません。その場合、この関数に渡されるキーハンドルと同じハンドルが返されます。</p>
<p>キーがすでに存在する場合、この関数はその既存のキーを開きます。</p>
<p>戻り値は開かれたキーのハンドルです。関数が失敗した場合、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.CreateKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>.</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.CreateKeyEx">
<code class="descclassname">winreg.</code><code class="descname">CreateKeyEx</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>reserved=0</em>, <em>access=KEY_WRITE</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CreateKeyEx" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーを生成するか開き、 <a class="reference internal" href="#handle-object"><span class="std std-ref">ハンドルオブジェクト</span></a> を返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> はこのメソッドが開く、または新規作成するキーの名前です。</p>
<p><em>reserved</em> は予約された整数で、 0 でなくてはなりません。デフォルト値は 0 です。</p>
<p><em>access</em> は、 key に対して想定されるセキュリティアクセスを示すアクセスマスクを指定する整数です。デフォルトは <a class="reference internal" href="#winreg.KEY_WRITE" title="winreg.KEY_WRITE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_WRITE</span></code></a> です。その他の利用可能な値については <a class="reference internal" href="#access-rights"><span class="std std-ref">アクセス権</span></a> を参照してください。</p>
<p><em>key</em> が事前に定義されたキーのうちの一つなら、<em>sub_key</em> は <code class="docutils literal notranslate"><span class="pre">None</span></code> でかまいません。その場合、この関数に渡されるキーハンドルと同じハンドルが返されます。</p>
<p>キーがすでに存在する場合、この関数はその既存のキーを開きます。</p>
<p>戻り値は開かれたキーのハンドルです。関数が失敗した場合、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.CreateKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>.</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.2 で追加.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteKey">
<code class="descclassname">winreg.</code><code class="descname">DeleteKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーを削除します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em>  は文字列で、<em>key</em> 引数によって指定されたキーのサブキーでなければなりません。この値は <code class="docutils literal notranslate"><span class="pre">None</span></code> であってはならず、キーはサブキーを持っていなくてもかまいません。</p>
<p><em>このメソッドはサブキーをもつキーを削除することはできません。</em></p>
<p>このメソッドの実行が成功すると、キー全体が、その値すべてを含めて削除されます。このメソッドが失敗した場合、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteKeyEx">
<code class="descclassname">winreg.</code><code class="descname">DeleteKeyEx</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>access=KEY_WOW64_64KEY</em>, <em>reserved=0</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteKeyEx" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーを削除します。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last"><a class="reference internal" href="#winreg.DeleteKeyEx" title="winreg.DeleteKeyEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">DeleteKeyEx()</span></code></a> 関数は、Windows の 64-bit バージョンに特有の RegDeleteKeyEx Windows API 関数を使用して実装されています。 <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms724847%28VS.85%29.aspx">RegDeleteKeyEx documentation</a> を参照してください。</p>
</div>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> は <em>key</em> 引数によって指定された key の subkey でなければなりません。この値は <code class="docutils literal notranslate"><span class="pre">None</span></code> であってはなりません。また、key は subkey を持たないかもしれません。</p>
<p><em>reserved</em> は予約された整数で、 0 でなくてはなりません。デフォルト値は 0 です。</p>
<p><em>access</em> は、 key に対して想定されるセキュリティアクセスを示すアクセスマスクを指定する整数です。デフォルトは <a class="reference internal" href="#winreg.KEY_WOW64_64KEY" title="winreg.KEY_WOW64_64KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_WOW64_64KEY</span></code></a> です。その他の利用可能な値については <a class="reference internal" href="#access-rights"><span class="std std-ref">アクセス権</span></a> を参照してください。</p>
<p><em>このメソッドはサブキーをもつキーを削除することはできません。</em></p>
<p>このメソッドの実行が成功すると、キー全体が、その値すべてを含めて削除されます。このメソッドが失敗した場合、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されます。</p>
<p>サポートされていない Windows バージョンでは、 <a class="reference internal" href="exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 例外を発生させます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.2 で追加.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteValue">
<code class="descclassname">winreg.</code><code class="descname">DeleteValue</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteValue" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリキーから指定された名前つきの値を削除します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>value</em> は削除したい値を指定するための文字列です。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumKey">
<code class="descclassname">winreg.</code><code class="descname">EnumKey</code><span class="sig-paren">(</span><em>key</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>開かれているレジストリキーのサブキーを列挙し、文字列で返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>index</em> は整数値で、取得するキーのインデクスを指定します。</p>
<p>この関数は、呼び出されるたびに一つのサブキーの名前を取得します。この関数は通常、これ以上値がないことを示す <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されるまで繰り返し呼び出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnumKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumValue">
<code class="descclassname">winreg.</code><code class="descname">EnumValue</code><span class="sig-paren">(</span><em>key</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumValue" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>開かれているレジストリキーの値を列挙し、タプルで返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>index</em> は整数値で、取得する値のインデクスを指定します。</p>
<p>この関数は、呼び出されるたびに一つのサブキーの名前を取得します。この関数は通常、これ以上値がないことを示す <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 例外が送出されるまで繰り返し呼び出されます。</p>
<p>結果は 3 要素のタプルになります:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">インデックス</th>
<th class="head">意味</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>値の名前を指定する文字列</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>値のデータを保持するためのオブジェクトで、その型は背後のレジストリ型に依存します</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">2</span></code></td>
<td>値のデータ型を指定する整数です (<a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a> のドキュメント内のテーブルを参照してください)</td>
</tr>
</tbody>
</table>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnumValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<span class="target" id="index-0"></span><dl class="function">
<dt id="winreg.ExpandEnvironmentStrings">
<code class="descclassname">winreg.</code><code class="descname">ExpandEnvironmentStrings</code><span class="sig-paren">(</span><em>str</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ExpandEnvironmentStrings" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#winreg.REG_EXPAND_SZ" title="winreg.REG_EXPAND_SZ"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_EXPAND_SZ</span></code></a> のように、環境変数プレースホルダ <code class="docutils literal notranslate"><span class="pre">%NAME%</span></code> を文字列で展開します:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="s1">&#39;%windir%&#39;</span><span class="p">)</span>
<span class="go">&#39;C:\\Windows&#39;</span>
</pre></div>
</div>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.ExpandEnvironmentStrings</span></code> with argument <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.FlushKey">
<code class="descclassname">winreg.</code><code class="descname">FlushKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.FlushKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>キーのすべての属性をレジストリに書き込みます。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p>キーを変更するために <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> を呼ぶ必要はありません。レジストリの変更は怠惰なフラッシュ機構 (lazy flusher) を使ってフラッシュされます。また、システムの遮断時にもディスクにフラッシュされます。 <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a> と違って、 <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> メソッドはレジストリに全てのデータを書き終えたときにのみ返ります。アプリケーションは、レジストリへの変更を絶対に確実にディスク上に反映させる必要がある場合にのみ、 <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> を呼ぶべきです。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last"><a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> を呼び出す必要があるかどうか分からない場合、おそらくその必要はありません。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.LoadKey">
<code class="descclassname">winreg.</code><code class="descname">LoadKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.LoadKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーの下にサブキーを生成し、サブキーに指定されたファイルのレジストリ情報を記録します。</p>
<p><em>key</em> は <a class="reference internal" href="#winreg.ConnectRegistry" title="winreg.ConnectRegistry"><code class="xref py py-func docutils literal notranslate"><span class="pre">ConnectRegistry()</span></code></a> が返したハンドルか、定数 <a class="reference internal" href="#winreg.HKEY_USERS" title="winreg.HKEY_USERS"><code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_USERS</span></code></a> と <a class="reference internal" href="#winreg.HKEY_LOCAL_MACHINE" title="winreg.HKEY_LOCAL_MACHINE"><code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE</span></code></a> のどちらかです。</p>
<p><em>sub_key</em> は記録先のサブキーを指定する文字列です。</p>
<p><em>file_name</em> はレジストリデータを読み出すためのファイル名です。このファイルは <a class="reference internal" href="#winreg.SaveKey" title="winreg.SaveKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">SaveKey()</span></code></a> 関数で生成されたファイルでなくてはなりません。ファイル割り当てテーブル (FAT) ファイルシステム下では、ファイル名は拡張子を持っていてはなりません。</p>
<p>この関数を呼び出しているプロセスが <code class="xref py py-const docutils literal notranslate"><span class="pre">SE_RESTORE_PRIVILEGE</span></code> 特権を持たない場合には <a class="reference internal" href="#winreg.LoadKey" title="winreg.LoadKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">LoadKey()</span></code></a> の呼び出しは失敗します。この特権とは、許可とは違うので注意してください。詳細は <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms724889%28v=VS.85%29.aspx">RegLoadKey documentation</a> を参照してください。</p>
<p><em>key</em> が <a class="reference internal" href="#winreg.ConnectRegistry" title="winreg.ConnectRegistry"><code class="xref py py-func docutils literal notranslate"><span class="pre">ConnectRegistry()</span></code></a> によって返されたハンドルの場合、 <em>file_name</em> に指定されたパスはリモートコンピュータに対する相対パス名になります。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.LoadKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">file_name</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.OpenKey">
<code class="descclassname">winreg.</code><code class="descname">OpenKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>reserved=0</em>, <em>access=KEY_READ</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKey" title="この定義へのパーマリンク">¶</a></dt>
<dt id="winreg.OpenKeyEx">
<code class="descclassname">winreg.</code><code class="descname">OpenKeyEx</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>reserved=0</em>, <em>access=KEY_READ</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKeyEx" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーを開き、 <a class="reference internal" href="#handle-object"><span class="std std-ref">ハンドルオブジェクト</span></a> を返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> は開くサブキーを指定する文字列です。</p>
<p><em>reserved</em> は予約された整数で、 0 でなくてはなりません。デフォルト値は 0 です。</p>
<p><em>access</em> は、 key に対して想定されるセキュリティアクセスを示すアクセスマスクを指定する整数です。デフォルトは <a class="reference internal" href="#winreg.KEY_READ" title="winreg.KEY_READ"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_READ</span></code></a> です。その他の利用可能な値については <a class="reference internal" href="#access-rights"><span class="std std-ref">アクセス権</span></a> を参照してください。</p>
<p>指定されたキーへの新しいハンドルが返されます。</p>
<p>この関数が失敗すると、 <a class="reference internal" href="exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> が送出されます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>.</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.2 で変更: </span>名前付き引数が使用できるようになりました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.3 で変更: </span><a class="reference internal" href="#exception-changed"><span class="std std-ref">上記</span></a> を参照。</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryInfoKey">
<code class="descclassname">winreg.</code><code class="descname">QueryInfoKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryInfoKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>キーに関する情報をタプルとして返します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p>結果は 3 要素のタプルになります:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">インデックス</th>
<th class="head">意味</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>このキーが持つサブキーの数を表す整数。</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>このキーが持つ値の数を表す整数。</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">2</span></code></td>
<td>最後のキーの変更が (あれば) いつだったかを表す整数で、1601 年 1 月 1 日からの 100 ナノ秒単位で数えたもの。</td>
</tr>
</tbody>
</table>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryInfoKey</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValue">
<code class="descclassname">winreg.</code><code class="descname">QueryValue</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValue" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>キーに対する、名前付けられていない値を文字列で取得します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> は値が関連付けられているサブキーの名前を保持する文字列です。この引数が <code class="docutils literal notranslate"><span class="pre">None</span></code> または空文字列の場合、この関数は <em>key</em> で指定されたキーに対して <a class="reference internal" href="#winreg.SetValue" title="winreg.SetValue"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValue()</span></code></a> メソッドで設定された値を取得します。</p>
<p>レジストリ中の値は名前、型、およびデータから構成されています。このメソッドはあるキーのデータ中で、名前 <code class="docutils literal notranslate"><span class="pre">NULL</span></code> をもつ最初の値を取得します。しかし背後のAPI 呼び出しは型情報を返しません。なので、可能ならいつでも <a class="reference internal" href="#winreg.QueryValueEx" title="winreg.QueryValueEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">QueryValueEx()</span></code></a> を使うべきです。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">value_name</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValueEx">
<code class="descclassname">winreg.</code><code class="descname">QueryValueEx</code><span class="sig-paren">(</span><em>key</em>, <em>value_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValueEx" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>開かれたレジストリキーに関連付けられている、指定した名前の値に対して、型およびデータを取得します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>value_name</em> は要求する値を指定する文字列です。</p>
<p>結果は 2 つの要素からなるタプルです:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">インデックス</th>
<th class="head">意味</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>レジストリ要素の値。</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>この値のレジストリ型を表す整数。 (<a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a> のドキュメント内のテーブルを参照してください。)</td>
</tr>
</tbody>
</table>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">value_name</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SaveKey">
<code class="descclassname">winreg.</code><code class="descname">SaveKey</code><span class="sig-paren">(</span><em>key</em>, <em>file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SaveKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーと、そのサブキー全てを指定したファイルに保存します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>file_name</em> はレジストリデータを保存するファイルの名前です、このファイルはすでに存在していてはいけません。このファイル名が拡張子を含んでいる場合、 <a class="reference internal" href="#winreg.LoadKey" title="winreg.LoadKey"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadKey()</span></code></a> メソッドは、FAT ファイルシステムを使うことができません。</p>
<p><em>key</em> がリモートコンピュータ上にあるキーを表す場合、 <em>file_name</em> で記述されているパスはリモートコンピュータに対して相対的なパスになります。このメソッドの呼び出し側は <code class="xref py py-const docutils literal notranslate"><span class="pre">SeBackupPrivilege</span></code>  セキュリティ特権を保有していなければなりません。この特権とは、パーミッションとは異なるものです。詳細は <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms724878%28v=VS.85%29.aspx">Conflicts Between User Rights and Permissions documentation</a> を参照してください。</p>
<p>この関数は <em>security_attributes</em> を <code class="docutils literal notranslate"><span class="pre">NULL</span></code> にして API に渡します。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SaveKey</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">file_name</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValue">
<code class="descclassname">winreg.</code><code class="descname">SetValue</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>type</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValue" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>値を指定したキーに関連付けます。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>sub_key</em> は値が関連付けられているサブキーの名前を表す文字列です。</p>
<p><em>type</em> はデータの型を指定する整数です。現状では、この値は <a class="reference internal" href="#winreg.REG_SZ" title="winreg.REG_SZ"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_SZ</span></code></a> でなければならず、これは文字列だけがサポートされていることを示します。他のデータ型をサポートするには <a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a> を使ってください。</p>
<p><em>value</em> は新たな値を指定する文字列です。</p>
<p><em>sub_key</em> 引数で指定されたキーが存在しなければ、SetValue 関数で生成されます。</p>
<p>値の長さは利用可能なメモリによって制限されます。(2048 バイト以上の) 長い値はファイルに保存して、そのファイル名を設定レジストリに保存するべきです。そうすればレジストリを効率的に動作させる役に立ちます。</p>
<p><em>key</em> 引数に指定されたキーは <a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a> アクセスで開かれていなければなりません。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SetValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValueEx">
<code class="descclassname">winreg.</code><code class="descname">SetValueEx</code><span class="sig-paren">(</span><em>key</em>, <em>value_name</em>, <em>reserved</em>, <em>type</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValueEx" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>開かれたレジストリキーの値フィールドにデータを記録します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p><em>value_name</em> は値が関連付けられているサブキーの名前を表す文字列です。</p>
<p><em>reserved</em> は何もしません - API には常にゼロが渡されます。</p>
<p><em>type</em> はデータの型を指定する整数です。利用できる型については <a class="reference internal" href="#value-types"><span class="std std-ref">値の型</span></a> を参照してください。</p>
<p><em>value</em> は新たな値を指定する文字列です。</p>
<p>このメソッドではまた、指定されたキーに対して、さらに別の値や型情報を設定することができます。 <em>key</em> 引数で指定されたキーは <a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a> アクセスで開かれていなければなりません。</p>
<p>キーを開くには、 <a class="reference internal" href="#winreg.CreateKey" title="winreg.CreateKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CreateKey()</span></code></a> または <a class="reference internal" href="#winreg.OpenKey" title="winreg.OpenKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">OpenKey()</span></code></a> メソッドを使ってください。</p>
<p>値の長さは利用可能なメモリによって制限されます。(2048 バイト以上の) 長い値はファイルに保存して、そのファイル名を設定レジストリに保存するべきです。そうすればレジストリを効率的に動作させる役に立ちます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SetValue</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.DisableReflectionKey">
<code class="descclassname">winreg.</code><code class="descname">DisableReflectionKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DisableReflectionKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>64ビット OS上で動作している 32bit プロセスに対するレジストリリフレクションを無効にします。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p>32bit OS上では一般的に <a class="reference internal" href="exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 例外を発生させます。</p>
<p>key がリフレクションリストに無い場合は、この関数は成功しますが効果はありません。あるキーのリフレクションを無効にしても、そのキーのサブキーのリフレクションには全く影響しません。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DisableReflectionKey</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnableReflectionKey">
<code class="descclassname">winreg.</code><code class="descname">EnableReflectionKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnableReflectionKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定された、リフレクションが無効にされたキーのリフレクションを再び有効にします。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p>32bit OS上では一般的に <a class="reference internal" href="exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 例外を発生させます。</p>
<p>あるキーのリフレクションを再開しても、その全てのサブキーには影響しません。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnableReflectionKey</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryReflectionKey">
<code class="descclassname">winreg.</code><code class="descname">QueryReflectionKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryReflectionKey" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたキーのリフレクション状態を確認します。</p>
<p><em>key</em> はすでに開かれたキーか、既定の <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* 定数</span></a> のうちの一つです。</p>
<p>リフレクションが無効になっている場合、<code class="docutils literal notranslate"><span class="pre">True</span></code> を返します。</p>
<p>32bit OS上では一般的に <a class="reference internal" href="exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 例外を発生させます。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryReflectionKey</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="constants">
<span id="id2"></span><h2>定数<a class="headerlink" href="#constants" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">_winreg</span></code> の多くの関数で利用するために以下の定数が定義されています。</p>
<div class="section" id="hkey-constants">
<span id="id3"></span><h3>HKEY_* 定数<a class="headerlink" href="#hkey-constants" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="data">
<dt id="winreg.HKEY_CLASSES_ROOT">
<code class="descclassname">winreg.</code><code class="descname">HKEY_CLASSES_ROOT</code><a class="headerlink" href="#winreg.HKEY_CLASSES_ROOT" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキー以下のレジストリエントリは、ドキュメントのタイプ（またはクラス）や、それに関連付けられたプロパティを定義しています。シェルと COM アプリケーションがこの情報を利用します。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_CURRENT_USER">
<code class="descclassname">winreg.</code><code class="descname">HKEY_CURRENT_USER</code><a class="headerlink" href="#winreg.HKEY_CURRENT_USER" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキー以下のレジストリエントリは、現在のユーザーの設定を定義します。この設定には、環境変数、プログラムグループに関するデータ、カラー、プリンター、ネットワーク接続、アプリケーション設定などが含まれます。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_LOCAL_MACHINE">
<code class="descclassname">winreg.</code><code class="descname">HKEY_LOCAL_MACHINE</code><a class="headerlink" href="#winreg.HKEY_LOCAL_MACHINE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキー以下のレジストリエントリは、コンピュータの物理的な状態を定義します。これには、バスタイプ、システムメモリ、インストールされているソフトウェアやハードウェアが含まれます。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_USERS">
<code class="descclassname">winreg.</code><code class="descname">HKEY_USERS</code><a class="headerlink" href="#winreg.HKEY_USERS" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキー以下のレジストリエントリは、ローカルコンピュータの新規ユーザーのためのデフォルト設定や、現在のユーザーの設定を定義しています。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_PERFORMANCE_DATA">
<code class="descclassname">winreg.</code><code class="descname">HKEY_PERFORMANCE_DATA</code><a class="headerlink" href="#winreg.HKEY_PERFORMANCE_DATA" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキー以下のレジストリエントリは、パフォーマンスデータへのアクセスを可能にしています。実際にはデータはレジストリには格納されていません。レジストリ関数がシステムにソースからデータを集めさせます。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_CURRENT_CONFIG">
<code class="descclassname">winreg.</code><code class="descname">HKEY_CURRENT_CONFIG</code><a class="headerlink" href="#winreg.HKEY_CURRENT_CONFIG" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ローカルコンピュータシステムの現在のハードウェアプロファイルに関する情報を含みます。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_DYN_DATA">
<code class="descclassname">winreg.</code><code class="descname">HKEY_DYN_DATA</code><a class="headerlink" href="#winreg.HKEY_DYN_DATA" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このキーは Windows の 98 以降のバージョンでは利用されていません。</p>
</dd></dl>

</div>
<div class="section" id="access-rights">
<span id="id4"></span><h3>アクセス権限<a class="headerlink" href="#access-rights" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>より詳しい情報については、 <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms724878%28v=VS.85%29.aspx">Registry Key Security and Access</a> を参照してください。</p>
<dl class="data">
<dt id="winreg.KEY_ALL_ACCESS">
<code class="descclassname">winreg.</code><code class="descname">KEY_ALL_ACCESS</code><a class="headerlink" href="#winreg.KEY_ALL_ACCESS" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>STANDARD_RIGHTS_REQUIRED (<a class="reference internal" href="#winreg.KEY_QUERY_VALUE" title="winreg.KEY_QUERY_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_QUERY_VALUE</span></code></a>, <a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a>, <a class="reference internal" href="#winreg.KEY_CREATE_SUB_KEY" title="winreg.KEY_CREATE_SUB_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_SUB_KEY</span></code></a>, <a class="reference internal" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="winreg.KEY_ENUMERATE_SUB_KEYS"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_ENUMERATE_SUB_KEYS</span></code></a>, <a class="reference internal" href="#winreg.KEY_NOTIFY" title="winreg.KEY_NOTIFY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_NOTIFY</span></code></a>, <a class="reference internal" href="#winreg.KEY_CREATE_LINK" title="winreg.KEY_CREATE_LINK"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_LINK</span></code></a>) アクセス権限の組み合わせ。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_WRITE">
<code class="descclassname">winreg.</code><code class="descname">KEY_WRITE</code><a class="headerlink" href="#winreg.KEY_WRITE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>STANDARD_RIGHTS_WRITE (<a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a>, <a class="reference internal" href="#winreg.KEY_CREATE_SUB_KEY" title="winreg.KEY_CREATE_SUB_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_SUB_KEY</span></code></a>) アクセス権限の組み合わせ。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_READ">
<code class="descclassname">winreg.</code><code class="descname">KEY_READ</code><a class="headerlink" href="#winreg.KEY_READ" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>STANDARD_RIGHTS_READ (<a class="reference internal" href="#winreg.KEY_QUERY_VALUE" title="winreg.KEY_QUERY_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_QUERY_VALUE</span></code></a>, <a class="reference internal" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="winreg.KEY_ENUMERATE_SUB_KEYS"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_ENUMERATE_SUB_KEYS</span></code></a>, <a class="reference internal" href="#winreg.KEY_NOTIFY" title="winreg.KEY_NOTIFY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_NOTIFY</span></code></a>) アクセス権限の組み合わせ。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_EXECUTE">
<code class="descclassname">winreg.</code><code class="descname">KEY_EXECUTE</code><a class="headerlink" href="#winreg.KEY_EXECUTE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#winreg.KEY_READ" title="winreg.KEY_READ"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_READ</span></code></a> と同じ。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_QUERY_VALUE">
<code class="descclassname">winreg.</code><code class="descname">KEY_QUERY_VALUE</code><a class="headerlink" href="#winreg.KEY_QUERY_VALUE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリキーの値を問い合わせるのに必要。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_SET_VALUE">
<code class="descclassname">winreg.</code><code class="descname">KEY_SET_VALUE</code><a class="headerlink" href="#winreg.KEY_SET_VALUE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリの値を作成、削除、設定するのに必要。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_CREATE_SUB_KEY">
<code class="descclassname">winreg.</code><code class="descname">KEY_CREATE_SUB_KEY</code><a class="headerlink" href="#winreg.KEY_CREATE_SUB_KEY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリキーのサブキーを作るのに必要。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_ENUMERATE_SUB_KEYS">
<code class="descclassname">winreg.</code><code class="descname">KEY_ENUMERATE_SUB_KEYS</code><a class="headerlink" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリキーのサブキーを列挙するのに必要。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_NOTIFY">
<code class="descclassname">winreg.</code><code class="descname">KEY_NOTIFY</code><a class="headerlink" href="#winreg.KEY_NOTIFY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>レジストリキーやそのサブキーに対する変更通知を要求するのに必要。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_CREATE_LINK">
<code class="descclassname">winreg.</code><code class="descname">KEY_CREATE_LINK</code><a class="headerlink" href="#winreg.KEY_CREATE_LINK" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>システムでの利用のために予約されている。</p>
</dd></dl>

<div class="section" id="bit-specific">
<span id="bit-access-rights"></span><h4>64-bit 特有のアクセス権<a class="headerlink" href="#bit-specific" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>より詳しい情報については、 <a class="reference external" href="https://msdn.microsoft.com/en-us/library/aa384129(v=VS.85).aspx">Accessing an Alternate Registry View</a> を参照してください。</p>
<dl class="data">
<dt id="winreg.KEY_WOW64_64KEY">
<code class="descclassname">winreg.</code><code class="descname">KEY_WOW64_64KEY</code><a class="headerlink" href="#winreg.KEY_WOW64_64KEY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>64 bit Windows 上のアプリケーションが、64 bit のレジストリビュー上で操作する事を示します。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_WOW64_32KEY">
<code class="descclassname">winreg.</code><code class="descname">KEY_WOW64_32KEY</code><a class="headerlink" href="#winreg.KEY_WOW64_32KEY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>64 bit Windows 上のアプリケーションが、32 bit のレジストリビュー上で操作する事を示します。</p>
</dd></dl>

</div>
</div>
<div class="section" id="value-types">
<span id="id5"></span><h3>値の型<a class="headerlink" href="#value-types" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>より詳しい情報については、 <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms724884%28v=VS.85%29.aspx">Registry Value Types</a> を参照してください。</p>
<dl class="data">
<dt id="winreg.REG_BINARY">
<code class="descclassname">winreg.</code><code class="descname">REG_BINARY</code><a class="headerlink" href="#winreg.REG_BINARY" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>何らかの形式のバイナリデータ。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD">
<code class="descclassname">winreg.</code><code class="descname">REG_DWORD</code><a class="headerlink" href="#winreg.REG_DWORD" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>32 ビットの数。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD_LITTLE_ENDIAN">
<code class="descclassname">winreg.</code><code class="descname">REG_DWORD_LITTLE_ENDIAN</code><a class="headerlink" href="#winreg.REG_DWORD_LITTLE_ENDIAN" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>32 ビットのリトルエンディアン形式の数。<a class="reference internal" href="#winreg.REG_DWORD" title="winreg.REG_DWORD"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_DWORD</span></code></a> と等価。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD_BIG_ENDIAN">
<code class="descclassname">winreg.</code><code class="descname">REG_DWORD_BIG_ENDIAN</code><a class="headerlink" href="#winreg.REG_DWORD_BIG_ENDIAN" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>32 ビットのビッグエンディアン形式の数。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_EXPAND_SZ">
<code class="descclassname">winreg.</code><code class="descname">REG_EXPAND_SZ</code><a class="headerlink" href="#winreg.REG_EXPAND_SZ" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>環境変数を参照している、ヌル文字で終端された文字列。(<code class="docutils literal notranslate"><span class="pre">%PATH%</span></code>)。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_LINK">
<code class="descclassname">winreg.</code><code class="descname">REG_LINK</code><a class="headerlink" href="#winreg.REG_LINK" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Unicode のシンボリックリンク。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_MULTI_SZ">
<code class="descclassname">winreg.</code><code class="descname">REG_MULTI_SZ</code><a class="headerlink" href="#winreg.REG_MULTI_SZ" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ヌル文字で終端された文字列からなり、二つのヌル文字で終端されている配列。 (Python はこの終端の処理を自動的に行います。)</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_NONE">
<code class="descclassname">winreg.</code><code class="descname">REG_NONE</code><a class="headerlink" href="#winreg.REG_NONE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>定義されていない値の形式。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_QWORD">
<code class="descclassname">winreg.</code><code class="descname">REG_QWORD</code><a class="headerlink" href="#winreg.REG_QWORD" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>64 ビットの数。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.6 で追加.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_QWORD_LITTLE_ENDIAN">
<code class="descclassname">winreg.</code><code class="descname">REG_QWORD_LITTLE_ENDIAN</code><a class="headerlink" href="#winreg.REG_QWORD_LITTLE_ENDIAN" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>64 ビットのリトルエンディアン形式の数。<a class="reference internal" href="#winreg.REG_QWORD" title="winreg.REG_QWORD"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_QWORD</span></code></a> と等価。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.6 で追加.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_RESOURCE_LIST">
<code class="descclassname">winreg.</code><code class="descname">REG_RESOURCE_LIST</code><a class="headerlink" href="#winreg.REG_RESOURCE_LIST" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>デバイスドライバリソースのリスト。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_FULL_RESOURCE_DESCRIPTOR">
<code class="descclassname">winreg.</code><code class="descname">REG_FULL_RESOURCE_DESCRIPTOR</code><a class="headerlink" href="#winreg.REG_FULL_RESOURCE_DESCRIPTOR" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ハードウェアセッティング。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_RESOURCE_REQUIREMENTS_LIST">
<code class="descclassname">winreg.</code><code class="descname">REG_RESOURCE_REQUIREMENTS_LIST</code><a class="headerlink" href="#winreg.REG_RESOURCE_REQUIREMENTS_LIST" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ハードウェアリソースリスト。</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_SZ">
<code class="descclassname">winreg.</code><code class="descname">REG_SZ</code><a class="headerlink" href="#winreg.REG_SZ" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ヌル文字で終端された文字列。</p>
</dd></dl>

</div>
</div>
<div class="section" id="registry-handle-objects">
<span id="handle-object"></span><h2>レジストリハンドルオブジェクト<a class="headerlink" href="#registry-handle-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>このオブジェクトは Windows の HKEY オブジェクトをラップし、オブジェクトが破壊されたときに自動的にハンドルを閉じます。オブジェクトの <a class="reference internal" href="#winreg.PyHKEY.Close" title="winreg.PyHKEY.Close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Close()</span></code></a> メソッドと <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a> 関数のどちらも、後始末がきちんと行われることを保証するために呼び出すことができます。</p>
<p>このモジュールのレジストリ関数は全て、これらのハンドルオブジェクトの一つを返します。</p>
<p>このモジュールのレジストリ関数でハンドルオブジェクトを受理するものは全て整数も受理しますが、ハンドルオブジェクトを利用することを推奨します。</p>
<p>ハンドルオブジェクトは <a class="reference internal" href="../reference/datamodel.html#object.__bool__" title="object.__bool__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__bool__()</span></code></a> の意味構成を持ちます - すなわち</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">handle</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>は、ハンドルが現在有効な (閉じられたり切り離されたりしていない) 場合には <code class="docutils literal notranslate"><span class="pre">Yes</span></code> となります。</p>
<p>ハンドルオブジェクトは、比較の意味構成もサポートしています。このため、複数のハンドルオブジェクトが参照している下層の Windows ハンドル値が同じ場合、それらのハンドルオブジェクト同士の比較は真になります。</p>
<p>ハンドルオブジェクトは (例えば組み込みの <a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> 関数を使って) 整数に変換することができます。この場合、背後の Windows ハンドル値が返されます、また、 <a class="reference internal" href="#winreg.PyHKEY.Detach" title="winreg.PyHKEY.Detach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detach()</span></code></a>  メソッドを使って整数のハンドル値を返させると同時に、ハンドルオブジェクトから Windows ハンドルを切り離すこともできます。</p>
<dl class="method">
<dt id="winreg.PyHKEY.Close">
<code class="descclassname">PyHKEY.</code><code class="descname">Close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Close" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>背後の Windows ハンドルを閉じます。</p>
<p>ハンドルがすでに閉じられていてもエラーは送出されません。</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.Detach">
<code class="descclassname">PyHKEY.</code><code class="descname">Detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Detach" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ハンドルオブジェクトから Windows ハンドルを切り離します。</p>
<p>切り離される以前にそのハンドルを保持していた整数オブジェクトが返されます。ハンドルがすでに切り離されていたり閉じられていたりした場合、ゼロが返されます。</p>
<p>この関数を呼び出した後、ハンドルは確実に無効化されますが、閉じられるわけではありません。背後の Win32 ハンドルがハンドルオブジェクトよりも長く維持される必要がある場合にはこの関数を呼び出すとよいでしょう。</p>
<p class="audit-hook">Raises an <a class="reference internal" href="sys.html#auditing"><span class="std std-ref">auditing event</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.PyHKEY.Detach</span></code> with argument <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.__enter__">
<code class="descclassname">PyHKEY.</code><code class="descname">__enter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__enter__" title="この定義へのパーマリンク">¶</a></dt>
<dt id="winreg.PyHKEY.__exit__">
<code class="descclassname">PyHKEY.</code><code class="descname">__exit__</code><span class="sig-paren">(</span><em>*exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__exit__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>HKEY オブジェクトは <a class="reference internal" href="../reference/datamodel.html#object.__enter__" title="object.__enter__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__enter__()</span></code></a>, <a class="reference internal" href="../reference/datamodel.html#object.__exit__" title="object.__exit__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__exit__()</span></code></a> メソッドを実装していて、 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> 文のためのコンテキストプロトコルをサポートしています:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">OpenKey</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">key</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># work with key</span>
</pre></div>
</div>
<p>このコードは、 <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> ブロックから抜けるときに自動的に <em>key</em> を閉じます。</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">winreg</span></code> --- Windows レジストリへのアクセス</a><ul>
<li><a class="reference internal" href="#functions">関数</a></li>
<li><a class="reference internal" href="#constants">定数</a><ul>
<li><a class="reference internal" href="#hkey-constants">HKEY_* 定数</a></li>
<li><a class="reference internal" href="#access-rights">アクセス権限</a><ul>
<li><a class="reference internal" href="#bit-specific">64-bit 特有のアクセス権</a></li>
</ul>
</li>
<li><a class="reference internal" href="#value-types">値の型</a></li>
</ul>
</li>
<li><a class="reference internal" href="#registry-handle-objects">レジストリハンドルオブジェクト</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="msvcrt.html"
                        title="前の章へ"><code class="docutils literal notranslate"><span class="pre">msvcrt</span></code> --- MS VC++実行時システムの有用なルーチン群</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="winsound.html"
                        title="次の章へ"><code class="docutils literal notranslate"><span class="pre">winsound</span></code> --- Windows 用の音声再生インタフェース</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.8/Doc/library/winreg.rst"
            rel="nofollow">ソースコードを表示
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="winsound.html" title="winsound --- Windows 用の音声再生インタフェース"
             >次へ</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" title="msvcrt --- MS VC++実行時システムの有用なルーチン群"
             >前へ</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <a href="../index.html">3.8.3rc1 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows.html" >MS Windows 固有のサービス</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="クイック検索" type="text" name="q" />
          <input type="submit" value="検索" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">著作権</a> 2001-2020, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    最終更新: 5月 13, 2020
    <a href="https://docs.python.org/3/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>

  </body>
</html>